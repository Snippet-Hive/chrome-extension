(()=>{"use strict";let e;try{e=Object(function(){var e=new Error("Cannot find module './config.dev'");throw e.code="MODULE_NOT_FOUND",e}())}catch(e){console.log("config.dev not found, using production configuration.")}let n={BASE_URL:"https://api.snippethive.com/api/v1"};chrome.management.getSelf((t=>{"development"===t.installType&&e&&(n=e)})),chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0}).catch(console.error),chrome.runtime.onInstalled.addListener((()=>{chrome.contextMenus.create({id:"openSidePanel",title:"Open Snippet Hive",contexts:["all"]})})),chrome.contextMenus.onClicked.addListener(((e,n)=>{"openSidePanel"===e.menuItemId&&chrome.sidePanel.open({windowId:n.windowId})})),chrome.runtime.onMessage.addListener(((e,t,o)=>{switch(e.action){case"createSnippet":return function(e,t,o){const{title:c,code:r,language:s}=e.data;chrome.storage.local.get("accessToken",(e=>{e.accessToken?fetch(`${n.BASE_URL}/snippets`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`},body:JSON.stringify({title:c,code:r,codelanguage:s,isAIGenerated:!0})}).then((e=>{if(!e.ok)throw 401===e.status&&chrome.runtime.sendMessage({action:"logout"}),new Error("No access token found");return e.json()})).then((e=>{o({success:!0,data:e})})).catch((e=>{console.error(e),o({success:!1,error:e})})):o({success:!1,error:"No access token found"})}))}(e,0,o),!0;case"executeScript":return function(e,n,t){chrome.scripting.executeScript({world:"MAIN",target:{tabId:n.tab.id},func:()=>{const e=document.querySelector("div.bg-bg-000.flex.h-full.flex-col");if(e){const n=function(e){for(const n in e)if(n.startsWith("__reactFiber$")||n.startsWith("__reactInternalInstance$"))return e[n].pendingProps;return null}(e);if(n){const e=n.children[1].props,t=e.content,o=e.language;window.postMessage({type:"FROM_PAGE",code:t,language:o},"*")}else console.log("React props not found.")}else console.log("Parent div not found.")}},(e=>{chrome.runtime.lastError&&console.error("Script execution failed: ",JSON.stringify(chrome.runtime.lastError)),t({success:!0})}))}(0,t,o),!0;case"logout":return chrome.storage.local.remove("accessToken",(()=>{o({success:!0})})),!0;default:return!1}}))})();